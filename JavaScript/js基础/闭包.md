

# 闭包
<!--- - - -->

## 如何从外部读取局部变量？

```javascript
function f1(){
    var n=999;
    function f2(){
        alert(n);
    }
    return f2;
}
```

在上面的代码中，函数f2就被包括在函数f1内部，这时f1内部的所有局部变量，对f2都是可见的。但是反过来就不行，f2内部的局部变量，对f1 就是不可见的。这就是Javascript语言特有的“**链式作用域**”结构（chain scope），
子对象会一级一级地向上寻找所有父对象的变量。所以，父对象的所有变量，对子对象都是可见的，反之则不成立。



## 闭包的概念

上一节代码中的f2函数，就是闭包。

闭包就是能够读取其他函数内部变量的函数。

由于在Javascript语言中，只有函数内部的子函数才能读取局部变量，因此可以把闭包简单理解成“定义在一个函数内部的函数”。

所以，在本质上，闭包就是将函数内部和函数外部连接起来的一座桥梁。


## 闭包的用途

- 可以读取函数内部的变量
- 让变量的值始终保持在内存中。



变量的值始终保持在内存中example 

```javascript
function f1() {
	var n = 999;
	nAdd = function() {
		n += 1
	};

	function f2() {
		alert(n)
	}
	return f2
}
var result = f1();
result(); // 999
nAdd();
result(); // 1000
```

在这段代码中，result实际上就是闭包f2函数。它一共运行了两次，第一次的值是999，第二次的值是1000。这证明了，函数f1中的局部变量n一直保存在内存中，并没有在f1调用后被自动清除

为什么会这样呢？原因就在于f1是f2的父函数，而f2被赋给了一个全局变量，这导致f2始终在内存中，而f2的存在依赖于f1，因此f1也始终在内存中，不会在调用结束后，被垃圾回收机制（garbage collection）回收。


